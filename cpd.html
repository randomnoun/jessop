
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2020-12-23
 Rendered using Maven Reflow Skin 1.0.0 (http://andriusvelykis.github.com/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

	<head>
		<meta charset="UTF-8" />
		<title>CPD Results | randomnoun jessop</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="" />
		<meta http-equiv="content-language" content="en" />

		<link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/css/bootstrap.min.css" rel="stylesheet" />
		<link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/css/bootstrap-responsive.min.css" rel="stylesheet" />
		<link href="./css/docs.css" rel="stylesheet" />
		<link href="./css/reflow-skin.css" rel="stylesheet" />
		
		<link href="//yandex.st/highlightjs/7.3/styles/github.min.css" rel="stylesheet" />
		
		<link href="./css/lightbox.css" rel="stylesheet" />
		
		<link href="./css/site.css" rel="stylesheet" />
		<link href="./css/print.css" rel="stylesheet" media="print" />
		
		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->
		
<link rel="author" href="mailto:knoxg@randomnoun.com"/>
	</head>

	<body class="page-cpd project-jessop" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

		<div class="navbar navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<a class="brand" href="./"><span class="color-highlight">randomnoun</span> jessop</a>
					<div class="nav-collapse">
						<ul class="nav pull-right">
							<li><a href="index.html#Usage" title="Download">Download </a></li>
							<li><a href="https://github.com/randomnoun/jessop" title="Github" class="externalLink">Github </a></li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li><a href="index.html" title="Usage">Usage </a></li>
									<li><a href="apidocs/index.html?overview-summary.html" title="Javadocs">Javadocs </a></li>
									<li><a href="cobertura/index.html" title="Code coverage">Code coverage </a></li>
									<li><a href="xref/index.html" title="Source XRef">Source XRef </a></li>
									<li><a href="xref-test/index.html" title="Test XRef">Test XRef </a></li>
								</ul>
							</li>
						</ul>
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>
		
	<div class="container">
	
	<!-- Masthead
	================================================== -->
	<header class="jumbotron subhead">
		<div class="row" id="banner">
			<div class="span12">
				<div class="pull-left">
					<a href="./" id="bannerLeft"><h1><span class="color-highlight">randomnoun</span> jessop</h1></a>
					<p class="lead">Multi-language templates in the style of Java Server Pages</p>
				</div>
				<div class="pull-right">
				</div>
			</div>
		</div>
		<div>
			<ul class="breadcrumb">
				<li class="projectVersion version-date">Version: 1.0.15</li>
				<li class="divider">|</li>
				<li class="publishDate version-date">Last Published: 2020-12-23</li>
				<li class="divider">|</li>
				<li><a href="./" title="jessop">jessop </a></li>
				<li class="divider">/</li>
				<li>CPD Results</li>
			</ul>
		</div>
		<hr class="toc-separator" />
		<div id="toc-bar" class="navbar">
			<div class="navbar-inner">
				<div id="toc-scroll-target" class="container">
					<ul id="toc" class="nav">
						<li class="toplevel"><a href="#CPD_Results" title="CPD Results">CPD Results</a></li>
						<li class="divider-vertical"></li>
						<li class="toplevel"><a href="#Duplications" title="Duplications">Duplications</a></li>
					</ul>
				</div>
			</div>
		</div>
	</header>

	<div class="main-body">
	<div class="row">
		<div class="span12">
			<div class="body-content">
<div class="section"> 
 <div class="page-header">
  <h2 id="CPD_Results">CPD Results</h2>
 </div> 
 <p>The following document contains the results of PMD's <a class="externalLink" href="https://pmd.github.io/latest/pmd_userdocs_cpd.html">CPD</a> 6.29.0.</p> 
</div> 
<div class="section"> 
 <h2 id="Duplications">Duplications</h2> 
 <table border="0" class="bodyTable table table-striped table-hover"> 
  <thead> 
   <tr class="a"> 
    <th>File</th> 
    <th>Line</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr class="b"> 
    <td>com\randomnoun\common\jessop\engine\rhino\ScriptableMap.java</td> 
    <td><a href="./xref/com/randomnoun/common/jessop/engine/rhino/ScriptableMap.html#L31">31</a></td> 
   </tr> 
   <tr class="a"> 
    <td>com\randomnoun\common\jessop\engine\rhinoOpenjdk\ScriptableMap.java</td> 
    <td><a href="./xref/com/randomnoun/common/jessop/engine/rhinoOpenjdk/ScriptableMap.html#L32">32</a></td> 
   </tr> 
   <tr class="b"> 
    <td>com\randomnoun\common\jessop\engine\rhinoOracle\ScriptableMap.java</td> 
    <td><a href="./xref/com/randomnoun/common/jessop/engine/rhinoOracle/ScriptableMap.html#L32">32</a></td> 
   </tr> 
   <tr class="a"> 
    <td colspan="2"> 
     <div> 
      <pre>public class ScriptableMap extends NativeJavaObject {

    boolean reflect;
    Map map;
    final static String CLASSNAME = &quot;ScriptableMap&quot;;

    // Set up a custom constructor, for this class is somewhere between a host class and
    // a native wrapper, for which no standard constructor class exists
    public static void init(Scriptable scope) throws NoSuchMethodException {
        BaseFunction ctor = new BaseFunction(scope, ScriptableObject.getFunctionPrototype(scope)) {
            @Override
            public Scriptable construct(Context cx, Scriptable scope, Object[] args) {
                boolean reflect = false;
                if (args.length &gt; 2) {
                    throw new EvaluatorException(&quot;ScriptableMap() called with too many arguments&quot;);
                } if (args.length == 2) {
                    reflect = ScriptRuntime.toBoolean(args[1]);
                }
                return new ScriptableMap(scope, args.length == 0 ? null : args[0], reflect);
            }
            @Override
            public Object call(Context cx, Scriptable scope, Scriptable thisObj, Object[] args) {
                return construct(cx, scope, args);
            }
        };
        ScriptableObject.defineProperty(scope, CLASSNAME, ctor,
                ScriptableObject.DONTENUM | ScriptableObject.READONLY);
    }

    @SuppressWarnings(&quot;unchecked&quot;)
    private ScriptableMap(Scriptable scope, Object obj, boolean reflect) {
        this.parent = scope;
        this.reflect = reflect;
        if (obj instanceof Wrapper) {
            obj = ((Wrapper) obj).unwrap();
        }
        if (obj instanceof Map) {
            this.map = (Map) obj;
        } else if (obj == null || obj == Undefined.instance) {
            this.map = new HashMap();
        } else if (obj instanceof Scriptable) {
            this.map = new HashMap();
            Scriptable s = (Scriptable) obj;
            Object[] ids = s.getIds();
            for (Object id: ids) {
                if (id instanceof String) {
                    map.put(id, s.get((String)id, s));
                } else if (id instanceof Number) {
                    map.put(id, s.get(((Number)id).intValue(), s));
                }
            }
        } else {
            throw new EvaluatorException(&quot;Invalid argument to ScriptableMap(): &quot; + obj);
        }
        this.javaObject = this.map;
        this.staticType = this.map.getClass();
        initMembers();
        initPrototype(scope);

    }

    public ScriptableMap(Scriptable scope, Map map) {
        super(scope, map, map.getClass());
        this.map = map;
        initPrototype(scope);
    }

    /**
     * Set the prototype to the Object prototype so we can use object methods such as
     * getOwnPropertyNames, hasOwnProperty, keys etc.
     * @param scope the global scope for looking up the Object constructor
     */
    protected void initPrototype(Scriptable scope) {
        Scriptable objectProto = ScriptableObject.getClassPrototype(scope, &quot;Object&quot;);
        if (objectProto != null) {
            this.setPrototype(objectProto);
        }
    }

    public Object get(String name, Scriptable start) {
        if (map == null || (reflect &amp;&amp; super.has(name, start))) {
            return super.get(name, start);
        }
        return getInternal(name);
    }

    public Object get(int index, Scriptable start) {
        if (map == null) {
            return super.get(index, start);
        }
        return getInternal(new Integer(index));
    }

    private Object getInternal(Object key) {
        Object value = map.get(key);
        if (value == null) {
            return Scriptable.NOT_FOUND;
        }
        return ScriptUtils.javaToJS(value, getParentScope());
    }

    public boolean has(String name, Scriptable start) {
        if (map == null || (reflect &amp;&amp; super.has(name, start))) {
            return super.has(name, start);
        } else {
            return map.containsKey(name);
        }
    }

    public boolean has(int index, Scriptable start) {
        if (map == null) {
            return super.has(index, start);
        } else {
            return map.containsKey(new Integer(index));
        }
    }

    public void put(String name, Scriptable start, Object value) {
        if (map == null || (reflect &amp;&amp; super.has(name, start))) {
            super.put(name, start, value);
        } else {
            putInternal(name, value);
        }
    }

    public void put(int index, Scriptable start, Object value) {
        if (map == null) {
             super.put(index, start, value);
         } else {
             putInternal(new Integer(index), value);
        }
    }

    @SuppressWarnings(&quot;unchecked&quot;)
    private void putInternal(Object key, Object value) {
        try {
            map.put(key, ScriptUtils.jsToJava(value));
        } catch (RuntimeException e) {
            Context.throwAsScriptRuntimeEx(e);
        }
    }

    public void delete(String name) {
        if (map != null) {
            try {
                map.remove(name);
            } catch (RuntimeException e) {
                Context.throwAsScriptRuntimeEx(e);
            }
        } else {
            super.delete(name);
        }
    }

    public void delete(int index) {
        if (map != null) {
            try {
                map.remove(new Integer(index));
            } catch (RuntimeException e) {
                Context.throwAsScriptRuntimeEx(e);
            }
        } else {
            super.delete(index);
        }
    }

    public Object[] getIds() {
        if (map == null) {
            return super.getIds();
        } else {
            return map.keySet().toArray();
        }
    }

    public String toString() {
        if (map == null)
            return super.toString();
        return map.toString();
    }

    public Object getDefaultValue(Class typeHint) {
        return toString();
    }

    public Object unwrap() {
        return map;
    }

    public Map getMap() {
        return map;
    }

    public String getClassName() {
        return CLASSNAME;
    }
}</pre> 
     </div></td> 
   </tr> 
  </tbody> 
 </table> 
 <table border="0" class="bodyTable table table-striped table-hover"> 
  <thead> 
   <tr class="b"> 
    <th>File</th> 
    <th>Line</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr class="a"> 
    <td>com\randomnoun\common\jessop\engine\rhino\ScriptableList.java</td> 
    <td><a href="./xref/com/randomnoun/common/jessop/engine/rhino/ScriptableList.html#L33">33</a></td> 
   </tr> 
   <tr class="b"> 
    <td>com\randomnoun\common\jessop\engine\rhinoOpenjdk\ScriptableList.java</td> 
    <td><a href="./xref/com/randomnoun/common/jessop/engine/rhinoOpenjdk/ScriptableList.html#L35">35</a></td> 
   </tr> 
   <tr class="a"> 
    <td>com\randomnoun\common\jessop\engine\rhinoOracle\ScriptableList.java</td> 
    <td><a href="./xref/com/randomnoun/common/jessop/engine/rhinoOracle/ScriptableList.html#L35">35</a></td> 
   </tr> 
   <tr class="b"> 
    <td colspan="2"> 
     <div> 
      <pre>public class ScriptableList extends NativeJavaObject {

    List&lt;Object&gt; list;
    static final String CLASSNAME = &quot;ScriptableList&quot;;

    // Set up a custom constructor, for this class is somewhere between a host class and
    // a native wrapper, for which no standard constructor class exists
    public static void init(Scriptable scope) throws NoSuchMethodException {
        BaseFunction ctor = new BaseFunction(scope, ScriptableObject.getFunctionPrototype(scope)) {
            @Override
            public Scriptable construct(Context cx, Scriptable scope, Object[] args) {
                if (args.length &gt; 1) {
                    throw new EvaluatorException(&quot;ScriptableList() requires a java.util.List argument&quot;);
                }
                return new ScriptableList(scope, args.length == 0 ? null : args[0]);
            }
            @Override
            public Object call(Context cx, Scriptable scope, Scriptable thisObj, Object[] args) {
                return construct(cx, scope, args);
            }
        };
        ScriptableObject.defineProperty(scope, CLASSNAME, ctor,
                ScriptableObject.DONTENUM | ScriptableObject.READONLY);
    }

    /**
     * Create a ScriptableList wrapper around a java.util.List
     * @param scope the scope
     * @param obj the list, possibly wrapped
     */
    @SuppressWarnings(&quot;unchecked&quot;)
    private ScriptableList(Scriptable scope, Object obj) {
        this.parent = scope;
        if (obj instanceof Wrapper) {
            obj = ((Wrapper) obj).unwrap();
        }
        if (obj instanceof List) {
            this.javaObject = this.list = (List) obj;
        } else if (obj instanceof Collection) {
            this.javaObject = this.list = new ArrayList&lt;Object&gt;((Collection&lt;?&gt;) obj);
        } else if (obj instanceof Map) {
            this.javaObject = this.list = new ArrayList&lt;Object&gt;(((Map&lt;?,?&gt;)obj).values());
        } else if (obj == null || obj == Undefined.instance) {
            this.javaObject = this.list = new ArrayList&lt;Object&gt;();
        } else {
            throw new EvaluatorException(&quot;Invalid argument to ScriptableList(): &quot; + obj);
        }
        this.staticType = this.list.getClass();
        initMembers();
        initPrototype(scope);
    }


    /**
     * Create a ScriptableList wrapper around a java.util.List.
     * @param scope the scope
     * @param list the list instance
     */
    @SuppressWarnings(&quot;unchecked&quot;)
    public ScriptableList(Scriptable scope, List list) {
        super(scope, list, list.getClass());
        this.list = list;
        initPrototype(scope);
    }

    /**
     * Set the prototype to the Array prototype so we can use array methds such as
     * push, pop, shift, slice etc.
     * @param scope the global scope for looking up the Array constructor
     */
    protected void initPrototype(Scriptable scope) {
        Scriptable arrayProto = ScriptableObject.getClassPrototype(scope, &quot;Array&quot;);
        if (arrayProto != null) {
            this.setPrototype(arrayProto);
        }
    }

    public void delete(int index) {
        if (list != null) {
            try {
                list.remove(index);
            } catch (RuntimeException e) {
                throw Context.throwAsScriptRuntimeEx(e);
            }
        } else {
            super.delete(index);
        }
    }

    public Object get(int index, Scriptable start) {
        if (list == null)
            return super.get(index, start);
        try {
            if (index &lt; 0 || index &gt;= list.size()) {
                return Undefined.instance;
            } else {
                return ScriptUtils.javaToJS(list.get(index), getParentScope());
            }
        } catch (RuntimeException e) {
            throw Context.throwAsScriptRuntimeEx(e);
        }
    }

    public boolean has(int index, Scriptable start) {
        if (list == null)
            return super.has(index, start);
        return index &gt;= 0 &amp;&amp; index &lt; list.size();
    }

    public void put(String name, Scriptable start, Object value) {
        if (list != null &amp;&amp; &quot;length&quot;.equals(name)) {
            double d = ScriptRuntime.toNumber(value);
            long longVal = ScriptRuntime.toUint32(d);
            if (longVal != d) {
                String msg = ScriptRuntime.getMessage0(&quot;msg.arraylength.bad&quot;);
                throw ScriptRuntime.constructError(&quot;RangeError&quot;, msg);
            }
            int size = list.size();
            if (longVal &gt; size) {
                for (int i = size; i &lt; longVal; i++) {
                    // push nulls as undefined is probably meaningless to java code
                    list.add(null);
                }
            } else if (longVal &lt; size) {
                for (int i = size - 1; i &gt;= longVal; i--) {
                    list.remove(i);
                }
            }
        } else {
            super.put(name, start, value);
        }
    }

    public void put(int index, Scriptable start, Object value) {
        if (list != null) {
            try {
                if (index == list.size()) {
                    list.add(ScriptUtils.jsToJava(value));
                } else {
                    list.set(index, ScriptUtils.jsToJava(value));
                }
            } catch (RuntimeException e) {
                Context.throwAsScriptRuntimeEx(e);
            }
        } else {
            super.put(index, start, value);
        }
    }

    public Object get(String name, Scriptable start) {
        if (&quot;length&quot;.equals(name) &amp;&amp; list != null) {
            return new Integer(list.size());
        }
        return super.get(name, start);
    }

    public Object[] getIds() {
        if (list == null)
            return super.getIds();
        int size = list.size();
        Object[] ids = new Object[size];
        for (int i = 0; i &lt; size; ++i) {
            ids[i] = new Integer(i);
        }
        return ids;
    }

    public String toString() {
        if (list == null)
            return super.toString();
        return list.toString();
    }

    public Object getDefaultValue(Class typeHint) {
        return toString();
    }

    public Object unwrap() {
        return list;
    }

    public List getList() {
        return list;
    }

    public String getClassName() {
        return CLASSNAME;
    }
}</pre> 
     </div></td> 
   </tr> 
  </tbody> 
 </table> 
 <table border="0" class="bodyTable table table-striped table-hover"> 
  <thead> 
   <tr class="a"> 
    <th>File</th> 
    <th>Line</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr class="b"> 
    <td>com\randomnoun\common\jessop\engine\rhino\ScriptUtils.java</td> 
    <td><a href="./xref/com/randomnoun/common/jessop/engine/rhino/ScriptUtils.html#L33">33</a></td> 
   </tr> 
   <tr class="a"> 
    <td>com\randomnoun\common\jessop\engine\rhinoOpenjdk\ScriptUtils.java</td> 
    <td><a href="./xref/com/randomnoun/common/jessop/engine/rhinoOpenjdk/ScriptUtils.html#L34">34</a></td> 
   </tr> 
   <tr class="b"> 
    <td>com\randomnoun\common\jessop\engine\rhinoOracle\ScriptUtils.java</td> 
    <td><a href="./xref/com/randomnoun/common/jessop/engine/rhinoOracle/ScriptUtils.html#L34">34</a></td> 
   </tr> 
   <tr class="a"> 
    <td colspan="2"> 
     <div> 
      <pre>public class ScriptUtils {

    /**
     * Coerce/wrap a java object to a JS object, and mask Lists and Maps
     * as native JS objects.
     * @param obj the object to coerce/wrap
     * @param scope the scope
     * @return the wrapped/masked java object
     */
    @SuppressWarnings(&quot;unchecked&quot;)
    public static Object javaToJS(Object obj, Scriptable scope) {
        if (obj instanceof Scriptable) {
            if (obj instanceof ScriptableObject
                    &amp;&amp; ((Scriptable) obj).getParentScope() == null
                    &amp;&amp; ((Scriptable) obj).getPrototype() == null) {
                ScriptRuntime.setObjectProtoAndParent((ScriptableObject) obj, scope);
            }
            return obj;
        } else if (obj instanceof List) {
            return new ScriptableList(scope, (List) obj);
        } else if (obj instanceof Map) {
            return new ScriptableMap(scope, (Map) obj);
        } else {
            return Context.javaToJS(obj, scope);
        }
    }

    /**
     * Unwrap a JS object to a java object. This is much more conservative than
     * Context.jsToJava in that it will preserve undefined values.
     * @param obj a JavaScript value
     * @return a Java object corresponding to obj
     */
    public static Object jsToJava(Object obj) {
        while (obj instanceof Wrapper) {
            obj = ((Wrapper) obj).unwrap();
        }
        return obj;
    }

    /**
     * Return a class prototype, or the object prototype if the class
     * is not defined.
     * @param scope the scope
     * @param className the class name
     * @return the class or object prototype
     */
    public static Scriptable getClassOrObjectProto(Scriptable scope, String className) {
        Scriptable proto = ScriptableObject.getClassPrototype(scope, className);
        if (proto == null) {
            proto = ScriptableObject.getObjectPrototype(scope);
        }
        return proto;
    }

    /**
     * Make sure that number of arguments is valid.
     * @param args the argument array
     * @param min the minimum number of arguments
     * @param max the maximum number of arguments
     * @throws IllegalArgumentException if the number of arguments is not valid
     */
    public static void checkArguments(Object[] args, int min, int max) {
        if (min &gt; -1 &amp;&amp; args.length &lt; min)
            throw new IllegalArgumentException();
        if (max &gt; -1 &amp;&amp; args.length &gt; max)
            throw new IllegalArgumentException();
    }

    /**
     * Get an argument as ScriptableObject
     * @param args the argument array
     * @param pos the position of the requested argument
     * @return the argument as ScriptableObject
     * @throws IllegalArgumentException if the argument can't be converted to a map
     */
    public static ScriptableObject getScriptableArgument(Object[] args, int pos, boolean allowNull)
            throws IllegalArgumentException {
        if (pos &gt;= args.length || args[pos] == null || args[pos] == Undefined.instance) {
            if (allowNull) return null;
            throw ScriptRuntime.constructError(&quot;Error&quot;, &quot;Argument &quot; + (pos + 1) + &quot; must not be null&quot;);
        } if (args[pos] instanceof ScriptableObject) {
            return (ScriptableObject) args[pos];
        }
        throw ScriptRuntime.constructError(&quot;Error&quot;, &quot;Can't convert to ScriptableObject: &quot; + args[pos]);
    }

    /**
     * Get an argument as string
     * @param args the argument array
     * @param pos the position of the requested argument
     * @return the argument as string
     */
    public static String getStringArgument(Object[] args, int pos, boolean allowNull) {
        if (pos &gt;= args.length || args[pos] == null || args[pos] == Undefined.instance) {
            if (allowNull) return null;
            throw ScriptRuntime.constructError(&quot;Error&quot;, &quot;Argument &quot; + (pos + 1) + &quot; must not be null&quot;);
        }
        return ScriptRuntime.toString(args[pos].toString());
    }

    /**
     * Get an argument as Map
     * @param args the argument array
     * @param pos the position of the requested argument
     * @return the argument as map
     * @throws IllegalArgumentException if the argument can't be converted to a map
     */
    public static Map getMapArgument(Object[] args, int pos, boolean allowNull)
            throws IllegalArgumentException {
        if (pos &gt;= args.length || args[pos] == null || args[pos] == Undefined.instance) {
            if (allowNull) return null;
            throw ScriptRuntime.constructError(&quot;Error&quot;, &quot;Argument &quot; + (pos + 1) + &quot; must not be null&quot;);
        } if (args[pos] instanceof Map) {
            return (Map) args[pos];
        }
        throw ScriptRuntime.constructError(&quot;Error&quot;, &quot;Can't convert to java.util.Map: &quot; + args[pos]);
    }

    /**
     * Get an argument as object
     * @param args the argument array
     * @param pos the position of the requested argument
     * @return the argument as object
     */
    public static Object getObjectArgument(Object[] args, int pos, boolean allowNull) {
        if (pos &gt;= args.length || args[pos] == null || args[pos] == Undefined.instance) {
            if (allowNull) return null;
            throw ScriptRuntime.constructError(&quot;Error&quot;, &quot;Argument &quot; + (pos + 1) + &quot; must not be null&quot;);
        }
        return args[pos];
    }

    /**
     * Try to convert an object to an int value, returning the default value if conversion fails.
     * @param obj the value
     * @param defaultValue the default value
     * @return the converted value
     */
    public static int toInt(Object obj, int defaultValue) {
        double d = ScriptRuntime.toNumber(obj);
        if (d == ScriptRuntime.NaN || (int)d != d) {
            return defaultValue;
        }
        return (int) d;
    }


    /**
     * Get a snapshot of the current JavaScript evaluation state by creating
     * an Error object and invoke the function on it passing along any arguments.
     * Used to invoke console.trace() and friends because implementing this
     * in JavaScript would mess with the evaluation state.
     * @param function the function to call
     * @param args optional arguments to pass to the function.
     */
    public static void traceHelper(Function function, Object... args) {
        Context cx = Context.getCurrentContext();
        Scriptable scope = ScriptableObject.getTopLevelScope(function);
        EcmaError error = ScriptRuntime.constructError(&quot;Trace&quot;, &quot;&quot;);
        WrapFactory wrapFactory = cx.getWrapFactory();
        Scriptable thisObj = wrapFactory.wrapAsJavaObject(cx, scope, error, null);
        for (int i = 0; i &lt; args.length; i++) {
            args[i] = wrapFactory.wrap(cx, scope, args[i], null);
        }
        function.call(cx, scope, thisObj, args);
    }

    /**
     * Helper for console.assert(). Implemented in Java in order not to
     * modify the JavaScript stack.
     * @param condition the condition to test
     * @param args one or more message parts
     */
    public static void assertHelper(Object condition, Object... args) {
        if (ScriptRuntime.toBoolean(condition)) {
            return;
        }
        // assertion failed
        String msg = &quot;&quot;;
        if (args.length &gt; 0) {
            msg = ScriptRuntime.toString(args[0]);
            Pattern pattern = Pattern.compile(&quot;%[sdifo]&quot;);
            for (int i = 1; i &lt; args.length; i++) {
                Matcher matcher = pattern.matcher(msg);
                if (matcher.find()) {
                    msg = matcher.replaceFirst(ScriptRuntime.toString(args[i]));
                } else {
                    msg = msg + &quot; &quot; + ScriptRuntime.toString(args[i]);
                }
            }
        }
        throw ScriptRuntime.constructError(&quot;AssertionError&quot;, msg);
    }

}</pre> 
     </div></td> 
   </tr> 
  </tbody> 
 </table> 
 <table border="0" class="bodyTable table table-striped table-hover"> 
  <thead> 
   <tr class="b"> 
    <th>File</th> 
    <th>Line</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr class="a"> 
    <td>com\randomnoun\common\jessop\lang\JavaJessopScriptBuilder.java</td> 
    <td><a href="./xref/com/randomnoun/common/jessop/lang/JavaJessopScriptBuilder.html#L33">33</a></td> 
   </tr> 
   <tr class="b"> 
    <td>com\randomnoun\common\jessop\lang\JavascriptJessopScriptBuilder.java</td> 
    <td><a href="./xref/com/randomnoun/common/jessop/lang/JavascriptJessopScriptBuilder.html#L34">34</a></td> 
   </tr> 
   <tr class="a"> 
    <td colspan="2"> 
     <div> 
      <pre>private static String escapeJava(String string) {
    	StringBuilder sb = new StringBuilder(string.length());
		for (int i = 0; i&lt;string.length(); i++) {
			char ch = string.charAt(i);
			if (ch=='\n') {
			   sb.append(&quot;\\n&quot;);	
			} else if (ch=='\\' || ch=='&quot;' || ch=='\'' || ch&lt;32 || ch&gt;126) {
				String hex = Integer.toString(ch, 16);
				sb.append(&quot;\\u&quot; + &quot;0000&quot;.substring(0, 4-hex.length()) + hex);
			} else {
				sb.append(ch);
			}
		}
        return sb.toString();
    }

	@Override
	public void emitText(int line, String s) {
		skipToLine(line);
		s = suppressEol(s, declarations.isSuppressEol() &amp;&amp; lastScriptletLine == line);
		print(&quot;out.write(\&quot;&quot; + escapeJava(s) + &quot;\&quot;);&quot;);</pre> 
     </div></td> 
   </tr> 
  </tbody> 
 </table> 
 <table border="0" class="bodyTable table table-striped table-hover"> 
  <thead> 
   <tr class="b"> 
    <th>File</th> 
    <th>Line</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr class="a"> 
    <td>com\randomnoun\common\jessop\lang\LuaJessopScriptBuilder.java</td> 
    <td><a href="./xref/com/randomnoun/common/jessop/lang/LuaJessopScriptBuilder.html#L18">18</a></td> 
   </tr> 
   <tr class="b"> 
    <td>com\randomnoun\common\jessop\lang\RubyJessopScriptBuilder.java</td> 
    <td><a href="./xref/com/randomnoun/common/jessop/lang/RubyJessopScriptBuilder.html#L18">18</a></td> 
   </tr> 
   <tr class="a"> 
    <td colspan="2"> 
     <div> 
      <pre>public LuaJessopScriptBuilder() {
	}
	private void skipToLine(int line) {
		while (outputLine &lt; line) { print(&quot;\n&quot;); }
	}
	private void print(String s) {
		// logger.info(&quot;** PRINT &quot; + s);
		pw.print(s);
		for (int i=0; i&lt;s.length(); i++) {
			if (s.charAt(i)=='\n') { outputLine++; } 
		}
	}
	private static String escapeLua(String string) {
		/* valid escapes ( https://www.lua.org/pil/2.4.html )
\a	bell
\b	back space
\f	form feed
\n	newline
\r	carriage return
\t	horizontal tab
\v	vertical tab
\\	backslash
\&quot;	double quote
\'	single quote
\[	left square bracket
\]	right square bracket
		 */
		
    	StringBuilder sb = new StringBuilder(string.length());
    	String escapeChars = &quot;\u0007&quot; + &quot;\u0008&quot; + &quot;\u000f&quot; + &quot;\n&quot; + &quot;\r&quot; + &quot;\u0009&quot; + &quot;\u000b&quot; + &quot;\\&quot; + &quot;\&quot;&quot; + &quot;'&quot; + &quot;[&quot; + &quot;]&quot;;</pre> 
     </div></td> 
   </tr> 
  </tbody> 
 </table> 
</div>
			</div>
		</div>
	</div>
	</div>

	</div><!-- /container -->
	
	<!-- Footer
	================================================== -->
	<footer class="well">
		<div class="container">
			<div class="row">
				<div class="span2 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Main</li>
						<li>
							<a href="index.html" title="Home">Home </a>
						</li>
						<li>
							<a href="https://github.com/randomnoun/jessop" title="Github project" class="externalLink">Github project </a>
						</li>
						<li>
							<a href="changes-report.html" title="Release notes">Release notes </a>
						</li>
					</ul>
				</div>
				<div class="span2 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Download</li>
						<li>
							<a href="index.html#Usage" title="Download">Download </a>
						</li>
						<li>
							<a href="license.html" title="License">License </a>
						</li>
					</ul>
				</div>
				<div class="span2 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Documentation</li>
						<li>
							<a href="index.html" title="Usage">Usage </a>
						</li>
						<li>
							<a href="apidocs/index.html?overview-summary.html" title="Javadocs">Javadocs </a>
						</li>
						<li>
							<a href="cobertura/index.html" title="Code coverage">Code coverage </a>
						</li>
						<li>
							<a href="xref/index.html" title="Source XRef">Source XRef </a>
						</li>
						<li>
							<a href="xref-test/index.html" title="Test XRef">Test XRef </a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Maven documentation</li>
						<li>
							<a href="project-info.html" title="Project Information">Project Information <i class="icon-chevron-right"></i></a>
						</li>
						<li>
							<a href="project-reports.html" title="Project Reports">Project Reports <i class="icon-chevron-down"></i></a>
							<ul class="nav nav-list">
						<li class="active">
							<a href="#" title="CPD">CPD </a>
						</li>
						<li>
							<a href="pmd.html" title="PMD">PMD </a>
						</li>
						<li>
							<a href="apidocs/index.html" title="Javadoc">Javadoc </a>
						</li>
						<li>
							<a href="testapidocs/index.html" title="Test Javadoc">Test Javadoc </a>
						</li>
						<li>
							<a href="surefire-report.html" title="Surefire Report">Surefire Report </a>
						</li>
						<li>
							<a href="xref/index.html" title="Source Xref">Source Xref </a>
						</li>
						<li>
							<a href="xref-test/index.html" title="Test Source Xref">Test Source Xref </a>
						</li>
							</ul>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-description">
					<blockquote><span class="color-highlight">jessop</span> is a Maven project which provides
multi-language templates in the style of <a href="https://www.jcp.org/en/jsr/detail?id=245">Java Server Pages</a>.</blockquote>
				</div>
			</div>
		</div>
	</footer>
		
	<div class="container subfooter">
		<div class="row">
			<div class="span12">
				<p class="pull-right"><a href="#">Back to top</a></p>
				<p class="copyright">Copyright &copy;2016-09-16-2020 <a href="http://www.randomnoun.com">randomnoun</a>. All Rights Reserved.</p>
				<p><a href="http://github.com/andriusvelykis/reflow-maven-skin" title="Reflow Maven skin">Reflow Maven skin</a> by <a href="http://andrius.velykis.lt" target="_blank" title="Andrius Velykis">Andrius Velykis</a>.</p>
			</div>
		</div>
	</div>

	<!-- Le javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->

	<!-- Fallback jQuery loading from Google CDN:
	     http://stackoverflow.com/questions/1014203/best-way-to-use-googles-hosted-jquery-but-fall-back-to-my-hosted-library-on-go -->
	<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
	<script type="text/javascript">
		if (typeof jQuery == 'undefined')
		{
			document.write(unescape("%3Cscript src='./js/jquery-1.8.3.min.js' type='text/javascript'%3E%3C/script%3E"));
		}
	</script>
	
	<script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/js/bootstrap.min.js"></script>
	<script src="./js/lightbox.js"></script>
	<script src="./js/jquery.smooth-scroll.min.js"></script>
	<!-- back button support for smooth scroll -->
	<script src="./js/jquery.ba-bbq.min.js"></script>
	<script src="//yandex.st/highlightjs/7.3/highlight.min.js"></script>

	<script src="./js/reflow-skin.js"></script>
	
	</body>
</html>
